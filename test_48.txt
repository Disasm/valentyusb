python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.cpu.epfifo_test
test_control_setup (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_control_setup_clears_stall (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_control_transfer_in (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_control_transfer_in_nak_data (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_control_transfer_in_nak_status (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_control_transfer_out (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_control_transfer_out_nak_data (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_control_transfer_out_nak_status (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_data_in_byte_1 (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_data_in_byte_2 (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_data_in_byte_a (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_data_toggle_bit_multiple_endpoints (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_in_stall (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_in_transfer (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_in_transfer_nak (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_out_stall (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_out_transfer (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_out_transfer_nak (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_setup_clears_data_toggle_bit (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_sof_is_ignored (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok
test_sof_stuffing (valentyusb.usbcore.cpu.epfifo_test.TestPerEndpointFifoInterface) ... ok

----------------------------------------------------------------------
Ran 21 tests in 1017.438s

OK
./run_all_tests.sh: line 7: ep(0,: command not found
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.cpu.epmem_test
test_control_setup (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... ok
test_control_setup_clears_stall (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... FAIL
test_control_transfer_in (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... FAIL
test_control_transfer_in_nak_data (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... ok
test_control_transfer_in_nak_status (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... FAIL
test_control_transfer_out (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... FAIL
test_control_transfer_out_nak_data (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... ok
test_control_transfer_out_nak_status (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... FAIL
test_data_in_byte_1 (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... ok
test_data_in_byte_2 (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... ok
test_data_in_byte_a (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... ok
test_data_toggle_bit_multiple_endpoints (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... FAIL
test_in_stall (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... FAIL
test_in_transfer (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... FAIL
test_in_transfer_nak (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... ok
test_out_stall (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... FAIL
test_out_transfer (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... FAIL
test_out_transfer_nak (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... ok
test_setup_clears_data_toggle_bit (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... FAIL
test_sof_is_ignored (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... ok
test_sof_stuffing (valentyusb.usbcore.cpu.epmem_test.TestMemInterface) ... ok

======================================================================
FAIL: test_control_setup_clears_stall (valentyusb.usbcore.cpu.epmem_test.TestMemInterface)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 615, in test_control_setup_clears_stall
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 65, in run_sim
    "usb_12": 32,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 53, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 600, in stim
    yield from self.expect_stall()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 258, in expect_stall
    yield from self.expect_packet(handshake_packet(PID.STALL), "Expected STALL packet.")
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 236, in expect_packet
    self.assertMultiLineEqualSideBySide(expected, actual, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 118, in assertMultiLineEqualSideBySide
    return assertMultiLineEqualSideBySide(data1, data2, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/utils/asserts.py", line 44, in assertMultiLineEqualSideBySide
    assert False, msg
AssertionError: Expected STALL packet.
      |expected                                                                                                                                 |actual
      |--------                                                                                                                                 |--------
     6|KKKK 5 Sync                                                                                                                             6|KKKK 5 Sync
     7|JJJJ 6 Sync                                                                                                                             7|JJJJ 6 Sync
     8|KKKK 7 Sync                                                                                                                             8|KKKK 7 Sync
     9|KKKK 8 Sync                                                                                                                             9|KKKK 8 Sync
    10|----                                                                                                                                   10|----
    11|JJJJ 1 PID (PID.STALL)                                                                                                           |     11|JJJJ 1 PID (PID.NAK)
    12|JJJJ 2 PID                                                                                                                             12|JJJJ 2 PID
    13|JJJJ 3 PID                                                                                                                       |     13|KKKK 3 PID
    14|JJJJ 4 PID                                                                                                                       |     14|KKKK 4 PID
    15|JJJJ 5 PID                                                                                                                       |     15|KKKK 5 PID
    16|KKKK 6 PID                                                                                                                       |     16|JJJJ 6 PID
    17|JJJJ 7 PID                                                                                                                             17|JJJJ 7 PID
    18|KKKK 8 PID                                                                                                                             18|KKKK 8 PID
    19|----                                                                                                                                   19|----
    20|____ SE0                                                                                                                               20|____ SE0
    21|____ SE0                                                                                                                               21|____ SE0

[     ]      |                !- !-  
[ <-  ]    11|JJJJ 1 PID (PID.STALL) 
[  -> ]    11|JJJJ 1 PID (PID.N AK ) 

[     ]      |!!!!       
[ <-  ]    13|JJJJ 3 PID 
[  -> ]    13|KKKK 3 PID 

[     ]      |!!!!       
[ <-  ]    14|JJJJ 4 PID 
[  -> ]    14|KKKK 4 PID 

[     ]      |!!!!       
[ <-  ]    15|JJJJ 5 PID 
[  -> ]    15|KKKK 5 PID 

[     ]      |!!!!       
[ <-  ]    16|KKKK 6 PID 
[  -> ]    16|JJJJ 6 PID 


======================================================================
FAIL: test_control_transfer_in (valentyusb.usbcore.cpu.epmem_test.TestMemInterface)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 631, in test_control_transfer_in
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 65, in run_sim
    "usb_12": 32,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 53, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 629, in stim
    0x08, 0x09, 0x0A, 0x0B],
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 415, in control_transfer_in
    yield from self.transaction_data_in(addr, epaddr_in, descriptor_data)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 368, in transaction_data_in
    yield from self.expect_data_packet(datax, chunk)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 243, in expect_data_packet
    yield from self.expect_packet(data_packet(pid, data), "Expected %s packet with %r" % (pid.name, data))
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 236, in expect_packet
    self.assertMultiLineEqualSideBySide(expected, actual, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 118, in assertMultiLineEqualSideBySide
    return assertMultiLineEqualSideBySide(data1, data2, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/utils/asserts.py", line 44, in assertMultiLineEqualSideBySide
    assert False, msg
AssertionError: Expected DATA1 packet with (0, 1, 2, 3, 4, 5, 6, 7)
      |expected                                                                                                                                 |actual
      |--------                                                                                                                                 |--------
     6|KKKK 5 Sync                                                                                                                             6|KKKK 5 Sync
     7|JJJJ 6 Sync                                                                                                                             7|JJJJ 6 Sync
     8|KKKK 7 Sync                                                                                                                             8|KKKK 7 Sync
     9|KKKK 8 Sync                                                                                                                             9|KKKK 8 Sync
    10|----                                                                                                                                   10|----
    11|KKKK 1 PID (PID.DATA1)                                                                                                           |     11|JJJJ 1 PID (PID.NAK)
    12|KKKK 2 PID                                                                                                                       |     12|JJJJ 2 PID
    13|JJJJ 3 PID                                                                                                                       |     13|KKKK 3 PID
    14|JJJJ 4 PID                                                                                                                       |     14|KKKK 4 PID
    15|KKKK 5 PID                                                                                                                             15|KKKK 5 PID
    16|JJJJ 6 PID                                                                                                                             16|JJJJ 6 PID
    17|JJJJ 7 PID                                                                                                                             17|JJJJ 7 PID
    18|KKKK 8 PID                                                                                                                             18|KKKK 8 PID
    19|----                                                                                                                                   19|----
    20|JJJJ                                                                                                                             <       |
    21|KKKK                                                                                                                             <       |
    22|JJJJ                                                                                                                             <       |
    23|KKKK                                                                                                                             <       |
    24|JJJJ                                                                                                                             <       |
    25|KKKK                                                                                                                             <       |
    26|JJJJ                                                                                                                             <       |
    27|KKKK                                                                                                                             <       |
    28|----                                                                                                                             <       |
    29|KKKK                                                                                                                             <       |
    30|JJJJ                                                                                                                             <       |
    31|KKKK                                                                                                                             <       |
    32|JJJJ                                                                                                                             <       |
    33|KKKK                                                                                                                             <       |
    34|JJJJ                                                                                                                             <       |
    35|KKKK                                                                                                                             <       |
    36|JJJJ                                                                                                                             <       |
    37|----                                                                                                                             <       |
    38|KKKK                                                                                                                             <       |
    39|KKKK                                                                                                                             <       |
    40|JJJJ                                                                                                                             <       |
    41|KKKK                                                                                                                             <       |
    42|JJJJ                                                                                                                             <       |
    43|KKKK                                                                                                                             <       |
    44|JJJJ                                                                                                                             <       |
    45|KKKK                                                                                                                             <       |
    46|----                                                                                                                             <       |
    47|KKKK                                                                                                                             <       |
    48|KKKK                                                                                                                             <       |
    49|JJJJ                                                                                                                             <       |
    50|KKKK                                                                                                                             <       |
    51|JJJJ                                                                                                                             <       |
    52|KKKK                                                                                                                             <       |
    53|JJJJ                                                                                                                             <       |
    54|KKKK                                                                                                                             <       |
    55|----                                                                                                                             <       |
    56|JJJJ                                                                                                                             <       |
    57|KKKK                                                                                                                             <       |
    58|KKKK                                                                                                                             <       |
    59|JJJJ                                                                                                                             <       |
    60|KKKK                                                                                                                             <       |
    61|JJJJ                                                                                                                             <       |
    62|KKKK                                                                                                                             <       |
    63|JJJJ                                                                                                                             <       |
    64|----                                                                                                                             <       |
    65|JJJJ                                                                                                                             <       |
    66|KKKK                                                                                                                             <       |
    67|KKKK                                                                                                                             <       |
    68|JJJJ                                                                                                                             <       |
    69|KKKK                                                                                                                             <       |
    70|JJJJ                                                                                                                             <       |
    71|KKKK                                                                                                                             <       |
    72|JJJJ                                                                                                                             <       |
    73|----                                                                                                                             <       |
    74|KKKK                                                                                                                             <       |
    75|KKKK                                                                                                                             <       |
    76|KKKK                                                                                                                             <       |
    77|JJJJ                                                                                                                             <       |
    78|KKKK                                                                                                                             <       |
    79|JJJJ                                                                                                                             <       |
    80|KKKK                                                                                                                             <       |
    81|JJJJ                                                                                                                             <       |
    82|----                                                                                                                             <       |
    83|JJJJ                                                                                                                             <       |
    84|JJJJ                                                                                                                             <       |
    85|JJJJ                                                                                                                             <       |
    86|KKKK                                                                                                                             <       |
    87|JJJJ                                                                                                                             <       |
    88|KKKK                                                                                                                             <       |
    89|JJJJ                                                                                                                             <       |
    90|KKKK                                                                                                                             <       |
    91|----                                                                                                                             <       |
    92|KKKK  1 CRC16                                                                                                                    <       |
    93|JJJJ  2 CRC16                                                                                                                    <       |
    94|KKKK  3 CRC16                                                                                                                    <       |
    95|KKKK  4 CRC16                                                                                                                    <       |
    96|KKKK  5 CRC16                                                                                                                    <       |
    97|KKKK  6 CRC16                                                                                                                    <       |
    98|JJJJ  7 CRC16                                                                                                                    <       |
    99|JJJJ  8 CRC16                                                                                                                    <       |
   100|----                                                                                                                             <       |
   101|JJJJ  9 CRC16                                                                                                                    <       |
   102|KKKK 10 CRC16                                                                                                                    <       |
   103|KKKK 11 CRC16                                                                                                                    <       |
   104|JJJJ 12 CRC16                                                                                                                    <       |
   105|KKKK 13 CRC16                                                                                                                    <       |
   106|JJJJ 14 CRC16                                                                                                                    <       |
   107|KKKK 15 CRC16                                                                                                                    <       |
   108|KKKK 16 CRC16                                                                                                                    <       |
   109|----                                                                                                                             <       |
   110|____ SE0                                                                                                                               20|____ SE0
   111|____ SE0                                                                                                                               21|____ SE0
   112|JJJJ END                                                                                                                               22|JJJJ END

[     ]      |!!!!            ! !--  
[ <-  ]    11|KKKK 1 PID (PID.DATA1) 
[  -> ]    11|JJJJ 1 PID (PID.NAK  ) 

[     ]      |!!!!       
[ <-  ]    12|KKKK 2 PID 
[  -> ]    12|JJJJ 2 PID 

[     ]      |!!!!       
[ <-  ]    13|JJJJ 3 PID 
[  -> ]    13|KKKK 3 PID 

[     ]      |!!!!       
[ <-  ]    14|JJJJ 4 PID 
[  -> ]    14|KKKK 4 PID 


======================================================================
FAIL: test_control_transfer_in_nak_status (valentyusb.usbcore.cpu.epmem_test.TestMemInterface)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 698, in test_control_transfer_in_nak_status
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 65, in run_sim
    "usb_12": 32,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 53, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 680, in stim
    yield from self.transaction_data_out(addr, epaddr_out, out_data)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 319, in transaction_data_out
    yield from self.expect_ack()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 248, in expect_ack
    yield from self.expect_packet(handshake_packet(PID.ACK), "Expected ACK packet.")
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 236, in expect_packet
    self.assertMultiLineEqualSideBySide(expected, actual, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 118, in assertMultiLineEqualSideBySide
    return assertMultiLineEqualSideBySide(data1, data2, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/utils/asserts.py", line 44, in assertMultiLineEqualSideBySide
    assert False, msg
AssertionError: Expected ACK packet.
      |expected                                                                                                                                 |actual
      |--------                                                                                                                                 |--------
     6|KKKK 5 Sync                                                                                                                             6|KKKK 5 Sync
     7|JJJJ 6 Sync                                                                                                                             7|JJJJ 6 Sync
     8|KKKK 7 Sync                                                                                                                             8|KKKK 7 Sync
     9|KKKK 8 Sync                                                                                                                             9|KKKK 8 Sync
    10|----                                                                                                                                   10|----
    11|JJJJ 1 PID (PID.ACK)                                                                                                             |     11|JJJJ 1 PID (PID.NAK)
    12|JJJJ 2 PID                                                                                                                             12|JJJJ 2 PID
    13|KKKK 3 PID                                                                                                                             13|KKKK 3 PID
    14|JJJJ 4 PID                                                                                                                       |     14|KKKK 4 PID
    15|JJJJ 5 PID                                                                                                                       |     15|KKKK 5 PID
    16|KKKK 6 PID                                                                                                                       |     16|JJJJ 6 PID
    17|KKKK 7 PID                                                                                                                       |     17|JJJJ 7 PID
    18|KKKK 8 PID                                                                                                                             18|KKKK 8 PID
    19|----                                                                                                                                   19|----
    20|____ SE0                                                                                                                               20|____ SE0
    21|____ SE0                                                                                                                               21|____ SE0
    22|JJJJ END                                                                                                                               22|JJJJ END

[     ]      |                + -   
[ <-  ]    11|JJJJ 1 PID (PID. ACK) 
[  -> ]    11|JJJJ 1 PID (PID.NA K) 

[     ]      |!!!!       
[ <-  ]    14|JJJJ 4 PID 
[  -> ]    14|KKKK 4 PID 

[     ]      |!!!!       
[ <-  ]    15|JJJJ 5 PID 
[  -> ]    15|KKKK 5 PID 

[     ]      |!!!!       
[ <-  ]    16|KKKK 6 PID 
[  -> ]    16|JJJJ 6 PID 

[     ]      |!!!!       
[ <-  ]    17|KKKK 7 PID 
[  -> ]    17|JJJJ 7 PID 


======================================================================
FAIL: test_control_transfer_out (valentyusb.usbcore.cpu.epmem_test.TestMemInterface)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 714, in test_control_transfer_out
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 65, in run_sim
    "usb_12": 32,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 53, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 712, in stim
    0x08, 0x09, 0x0A, 0x0B],
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 434, in control_transfer_out
    yield from self.transaction_data_out(addr, epaddr_out, descriptor_data)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 319, in transaction_data_out
    yield from self.expect_ack()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 248, in expect_ack
    yield from self.expect_packet(handshake_packet(PID.ACK), "Expected ACK packet.")
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 236, in expect_packet
    self.assertMultiLineEqualSideBySide(expected, actual, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 118, in assertMultiLineEqualSideBySide
    return assertMultiLineEqualSideBySide(data1, data2, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/utils/asserts.py", line 44, in assertMultiLineEqualSideBySide
    assert False, msg
AssertionError: Expected ACK packet.
      |expected                                                                                                                                 |actual
      |--------                                                                                                                                 |--------
     6|KKKK 5 Sync                                                                                                                             6|KKKK 5 Sync
     7|JJJJ 6 Sync                                                                                                                             7|JJJJ 6 Sync
     8|KKKK 7 Sync                                                                                                                             8|KKKK 7 Sync
     9|KKKK 8 Sync                                                                                                                             9|KKKK 8 Sync
    10|----                                                                                                                                   10|----
    11|JJJJ 1 PID (PID.ACK)                                                                                                             |     11|JJJJ 1 PID (PID.NAK)
    12|JJJJ 2 PID                                                                                                                             12|JJJJ 2 PID
    13|KKKK 3 PID                                                                                                                             13|KKKK 3 PID
    14|JJJJ 4 PID                                                                                                                       |     14|KKKK 4 PID
    15|JJJJ 5 PID                                                                                                                       |     15|KKKK 5 PID
    16|KKKK 6 PID                                                                                                                       |     16|JJJJ 6 PID
    17|KKKK 7 PID                                                                                                                       |     17|JJJJ 7 PID
    18|KKKK 8 PID                                                                                                                             18|KKKK 8 PID
    19|----                                                                                                                                   19|----
    20|____ SE0                                                                                                                               20|____ SE0
    21|____ SE0                                                                                                                               21|____ SE0
    22|JJJJ END                                                                                                                               22|JJJJ END

[     ]      |                + -   
[ <-  ]    11|JJJJ 1 PID (PID. ACK) 
[  -> ]    11|JJJJ 1 PID (PID.NA K) 

[     ]      |!!!!       
[ <-  ]    14|JJJJ 4 PID 
[  -> ]    14|KKKK 4 PID 

[     ]      |!!!!       
[ <-  ]    15|JJJJ 5 PID 
[  -> ]    15|KKKK 5 PID 

[     ]      |!!!!       
[ <-  ]    16|KKKK 6 PID 
[  -> ]    16|JJJJ 6 PID 

[     ]      |!!!!       
[ <-  ]    17|KKKK 7 PID 
[  -> ]    17|JJJJ 7 PID 


======================================================================
FAIL: test_control_transfer_out_nak_status (valentyusb.usbcore.cpu.epmem_test.TestMemInterface)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 798, in test_control_transfer_out_nak_status
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 65, in run_sim
    "usb_12": 32,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 53, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 778, in stim
    yield from self.transaction_data_in(addr, epaddr_in, descriptor_data)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 368, in transaction_data_in
    yield from self.expect_data_packet(datax, chunk)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 243, in expect_data_packet
    yield from self.expect_packet(data_packet(pid, data), "Expected %s packet with %r" % (pid.name, data))
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 236, in expect_packet
    self.assertMultiLineEqualSideBySide(expected, actual, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 118, in assertMultiLineEqualSideBySide
    return assertMultiLineEqualSideBySide(data1, data2, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/utils/asserts.py", line 44, in assertMultiLineEqualSideBySide
    assert False, msg
AssertionError: Expected DATA1 packet with (0, 1, 2, 3, 4, 5, 6, 7)
      |expected                                                                                                                                 |actual
      |--------                                                                                                                                 |--------
     6|KKKK 5 Sync                                                                                                                             6|KKKK 5 Sync
     7|JJJJ 6 Sync                                                                                                                             7|JJJJ 6 Sync
     8|KKKK 7 Sync                                                                                                                             8|KKKK 7 Sync
     9|KKKK 8 Sync                                                                                                                             9|KKKK 8 Sync
    10|----                                                                                                                                   10|----
    11|KKKK 1 PID (PID.DATA1)                                                                                                           |     11|JJJJ 1 PID (PID.NAK)
    12|KKKK 2 PID                                                                                                                       |     12|JJJJ 2 PID
    13|JJJJ 3 PID                                                                                                                       |     13|KKKK 3 PID
    14|JJJJ 4 PID                                                                                                                       |     14|KKKK 4 PID
    15|KKKK 5 PID                                                                                                                             15|KKKK 5 PID
    16|JJJJ 6 PID                                                                                                                             16|JJJJ 6 PID
    17|JJJJ 7 PID                                                                                                                             17|JJJJ 7 PID
    18|KKKK 8 PID                                                                                                                             18|KKKK 8 PID
    19|----                                                                                                                                   19|----
    20|JJJJ                                                                                                                             <       |
    21|KKKK                                                                                                                             <       |
    22|JJJJ                                                                                                                             <       |
    23|KKKK                                                                                                                             <       |
    24|JJJJ                                                                                                                             <       |
    25|KKKK                                                                                                                             <       |
    26|JJJJ                                                                                                                             <       |
    27|KKKK                                                                                                                             <       |
    28|----                                                                                                                             <       |
    29|KKKK                                                                                                                             <       |
    30|JJJJ                                                                                                                             <       |
    31|KKKK                                                                                                                             <       |
    32|JJJJ                                                                                                                             <       |
    33|KKKK                                                                                                                             <       |
    34|JJJJ                                                                                                                             <       |
    35|KKKK                                                                                                                             <       |
    36|JJJJ                                                                                                                             <       |
    37|----                                                                                                                             <       |
    38|KKKK                                                                                                                             <       |
    39|KKKK                                                                                                                             <       |
    40|JJJJ                                                                                                                             <       |
    41|KKKK                                                                                                                             <       |
    42|JJJJ                                                                                                                             <       |
    43|KKKK                                                                                                                             <       |
    44|JJJJ                                                                                                                             <       |
    45|KKKK                                                                                                                             <       |
    46|----                                                                                                                             <       |
    47|KKKK                                                                                                                             <       |
    48|KKKK                                                                                                                             <       |
    49|JJJJ                                                                                                                             <       |
    50|KKKK                                                                                                                             <       |
    51|JJJJ                                                                                                                             <       |
    52|KKKK                                                                                                                             <       |
    53|JJJJ                                                                                                                             <       |
    54|KKKK                                                                                                                             <       |
    55|----                                                                                                                             <       |
    56|JJJJ                                                                                                                             <       |
    57|KKKK                                                                                                                             <       |
    58|KKKK                                                                                                                             <       |
    59|JJJJ                                                                                                                             <       |
    60|KKKK                                                                                                                             <       |
    61|JJJJ                                                                                                                             <       |
    62|KKKK                                                                                                                             <       |
    63|JJJJ                                                                                                                             <       |
    64|----                                                                                                                             <       |
    65|JJJJ                                                                                                                             <       |
    66|KKKK                                                                                                                             <       |
    67|KKKK                                                                                                                             <       |
    68|JJJJ                                                                                                                             <       |
    69|KKKK                                                                                                                             <       |
    70|JJJJ                                                                                                                             <       |
    71|KKKK                                                                                                                             <       |
    72|JJJJ                                                                                                                             <       |
    73|----                                                                                                                             <       |
    74|KKKK                                                                                                                             <       |
    75|KKKK                                                                                                                             <       |
    76|KKKK                                                                                                                             <       |
    77|JJJJ                                                                                                                             <       |
    78|KKKK                                                                                                                             <       |
    79|JJJJ                                                                                                                             <       |
    80|KKKK                                                                                                                             <       |
    81|JJJJ                                                                                                                             <       |
    82|----                                                                                                                             <       |
    83|JJJJ                                                                                                                             <       |
    84|JJJJ                                                                                                                             <       |
    85|JJJJ                                                                                                                             <       |
    86|KKKK                                                                                                                             <       |
    87|JJJJ                                                                                                                             <       |
    88|KKKK                                                                                                                             <       |
    89|JJJJ                                                                                                                             <       |
    90|KKKK                                                                                                                             <       |
    91|----                                                                                                                             <       |
    92|KKKK  1 CRC16                                                                                                                    <       |
    93|JJJJ  2 CRC16                                                                                                                    <       |
    94|KKKK  3 CRC16                                                                                                                    <       |
    95|KKKK  4 CRC16                                                                                                                    <       |
    96|KKKK  5 CRC16                                                                                                                    <       |
    97|KKKK  6 CRC16                                                                                                                    <       |
    98|JJJJ  7 CRC16                                                                                                                    <       |
    99|JJJJ  8 CRC16                                                                                                                    <       |
   100|----                                                                                                                             <       |
   101|JJJJ  9 CRC16                                                                                                                    <       |
   102|KKKK 10 CRC16                                                                                                                    <       |
   103|KKKK 11 CRC16                                                                                                                    <       |
   104|JJJJ 12 CRC16                                                                                                                    <       |
   105|KKKK 13 CRC16                                                                                                                    <       |
   106|JJJJ 14 CRC16                                                                                                                    <       |
   107|KKKK 15 CRC16                                                                                                                    <       |
   108|KKKK 16 CRC16                                                                                                                    <       |
   109|----                                                                                                                             <       |
   110|____ SE0                                                                                                                               20|____ SE0
   111|____ SE0                                                                                                                               21|____ SE0
   112|JJJJ END                                                                                                                               22|JJJJ END

[     ]      |!!!!            ! !--  
[ <-  ]    11|KKKK 1 PID (PID.DATA1) 
[  -> ]    11|JJJJ 1 PID (PID.NAK  ) 

[     ]      |!!!!       
[ <-  ]    12|KKKK 2 PID 
[  -> ]    12|JJJJ 2 PID 

[     ]      |!!!!       
[ <-  ]    13|JJJJ 3 PID 
[  -> ]    13|KKKK 3 PID 

[     ]      |!!!!       
[ <-  ]    14|JJJJ 4 PID 
[  -> ]    14|KKKK 4 PID 


======================================================================
FAIL: test_data_toggle_bit_multiple_endpoints (valentyusb.usbcore.cpu.epmem_test.TestMemInterface)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 998, in test_data_toggle_bit_multiple_endpoints
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 65, in run_sim
    "usb_12": 32,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 53, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 986, in stim
    yield from self.expect_data_packet(PID.DATA0, d3)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 243, in expect_data_packet
    yield from self.expect_packet(data_packet(pid, data), "Expected %s packet with %r" % (pid.name, data))
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 236, in expect_packet
    self.assertMultiLineEqualSideBySide(expected, actual, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 118, in assertMultiLineEqualSideBySide
    return assertMultiLineEqualSideBySide(data1, data2, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/utils/asserts.py", line 44, in assertMultiLineEqualSideBySide
    assert False, msg
AssertionError: Expected DATA0 packet with [3]
      |expected                                                                                                                                 |actual
      |--------                                                                                                                                 |--------
     6|KKKK 5 Sync                                                                                                                             6|KKKK 5 Sync
     7|JJJJ 6 Sync                                                                                                                             7|JJJJ 6 Sync
     8|KKKK 7 Sync                                                                                                                             8|KKKK 7 Sync
     9|KKKK 8 Sync                                                                                                                             9|KKKK 8 Sync
    10|----                                                                                                                                   10|----
    11|KKKK 1 PID (PID.DATA0)                                                                                                           |     11|JJJJ 1 PID (PID.NAK)
    12|KKKK 2 PID                                                                                                                       |     12|JJJJ 2 PID
    13|JJJJ 3 PID                                                                                                                       |     13|KKKK 3 PID
    14|KKKK 4 PID                                                                                                                             14|KKKK 4 PID
    15|JJJJ 5 PID                                                                                                                       |     15|KKKK 5 PID
    16|KKKK 6 PID                                                                                                                       |     16|JJJJ 6 PID
    17|KKKK 7 PID                                                                                                                       |     17|JJJJ 7 PID
    18|KKKK 8 PID                                                                                                                             18|KKKK 8 PID
    19|----                                                                                                                             <       |
    20|KKKK                                                                                                                             <       |
    21|KKKK                                                                                                                             <       |
    22|JJJJ                                                                                                                             <       |
    23|KKKK                                                                                                                             <       |
    24|JJJJ                                                                                                                             <       |
    25|KKKK                                                                                                                             <       |
    26|JJJJ                                                                                                                             <       |
    27|KKKK                                                                                                                             <       |
    28|----                                                                                                                             <       |
    29|JJJJ  1 CRC16                                                                                                                    <       |
    30|KKKK  2 CRC16                                                                                                                    <       |
    31|JJJJ  3 CRC16                                                                                                                    <       |
    32|KKKK  4 CRC16                                                                                                                    <       |
    33|JJJJ  5 CRC16                                                                                                                    <       |
    34|KKKK  6 CRC16                                                                                                                    <       |
    35|JJJJ  7 CRC16                                                                                                                    <       |
    36|KKKK  8 CRC16                                                                                                                    <       |
    37|----                                                                                                                             <       |
    38|JJJJ  9 CRC16                                                                                                                    <       |
    39|JJJJ 10 CRC16                                                                                                                    <       |
    40|JJJJ 11 CRC16                                                                                                                    <       |
    41|JJJJ 12 CRC16                                                                                                                    <       |
    42|JJJJ 13 CRC16                                                                                                                    <       |
    43|JJJJ 14 CRC16                                                                                                                    <       |
    44|KKKK 15 CRC16                                                                                                                    <       |
    45|KKKK 16 CRC16                                                                                                                    <       |
    46|----                                                                                                                                   19|----
    47|____ SE0                                                                                                                               20|____ SE0
    48|____ SE0                                                                                                                               21|____ SE0
    49|JJJJ END                                                                                                                               22|JJJJ END

[     ]      |!!!!            ! !--  
[ <-  ]    11|KKKK 1 PID (PID.DATA0) 
[  -> ]    11|JJJJ 1 PID (PID.NAK  ) 

[     ]      |!!!!       
[ <-  ]    12|KKKK 2 PID 
[  -> ]    12|JJJJ 2 PID 

[     ]      |!!!!       
[ <-  ]    13|JJJJ 3 PID 
[  -> ]    13|KKKK 3 PID 

[     ]      |!!!!       
[ <-  ]    15|JJJJ 5 PID 
[  -> ]    15|KKKK 5 PID 

[     ]      |!!!!       
[ <-  ]    16|KKKK 6 PID 
[  -> ]    16|JJJJ 6 PID 

[     ]      |!!!!       
[ <-  ]    17|KKKK 7 PID 
[  -> ]    17|JJJJ 7 PID 


======================================================================
FAIL: test_in_stall (valentyusb.usbcore.cpu.epmem_test.TestMemInterface)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 1078, in test_in_stall
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 65, in run_sim
    "usb_12": 32,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 53, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 1057, in stim
    yield from self.expect_nak()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 253, in expect_nak
    yield from self.expect_packet(handshake_packet(PID.NAK), "Expected NAK packet.")
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 236, in expect_packet
    self.assertMultiLineEqualSideBySide(expected, actual, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 118, in assertMultiLineEqualSideBySide
    return assertMultiLineEqualSideBySide(data1, data2, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/utils/asserts.py", line 44, in assertMultiLineEqualSideBySide
    assert False, msg
AssertionError: Expected NAK packet.
      |expected                                                                                                                                 |actual
      |--------                                                                                                                                 |--------
     6|KKKK 5 Sync                                                                                                                             6|KKKK 5 Sync
     7|JJJJ 6 Sync                                                                                                                             7|JJJJ 6 Sync
     8|KKKK 7 Sync                                                                                                                             8|KKKK 7 Sync
     9|KKKK 8 Sync                                                                                                                             9|KKKK 8 Sync
    10|----                                                                                                                                   10|----
    11|JJJJ 1 PID (PID.NAK)                                                                                                             |     11|KKKK 1 PID (PID.DATA1)
    12|JJJJ 2 PID                                                                                                                       |     12|KKKK 2 PID
    13|KKKK 3 PID                                                                                                                       |     13|JJJJ 3 PID
    14|KKKK 4 PID                                                                                                                       |     14|JJJJ 4 PID
    15|KKKK 5 PID                                                                                                                             15|KKKK 5 PID
    16|JJJJ 6 PID                                                                                                                             16|JJJJ 6 PID
    17|JJJJ 7 PID                                                                                                                             17|JJJJ 7 PID
    18|KKKK 8 PID                                                                                                                             18|KKKK 8 PID
    19|----                                                                                                                                   19|----
      |                                                                                                                                 >     20|KKKK
      |                                                                                                                                 >     21|JJJJ
      |                                                                                                                                 >     22|KKKK
      |                                                                                                                                 >     23|JJJJ
      |                                                                                                                                 >     24|KKKK
      |                                                                                                                                 >     25|JJJJ
      |                                                                                                                                 >     26|KKKK
      |                                                                                                                                 >     27|JJJJ
      |                                                                                                                                 >     28|----
      |                                                                                                                                 >     29|KKKK
      |                                                                                                                                 >     30|KKKK
      |                                                                                                                                 >     31|JJJJ
      |                                                                                                                                 >     32|KKKK
      |                                                                                                                                 >     33|JJJJ
      |                                                                                                                                 >     34|KKKK
      |                                                                                                                                 >     35|JJJJ
      |                                                                                                                                 >     36|KKKK
      |                                                                                                                                 >     37|----
      |                                                                                                                                 >     38|KKKK
      |                                                                                                                                 >     39|KKKK
      |                                                                                                                                 >     40|JJJJ
      |                                                                                                                                 >     41|KKKK
      |                                                                                                                                 >     42|JJJJ
      |                                                                                                                                 >     43|KKKK
      |                                                                                                                                 >     44|JJJJ
      |                                                                                                                                 >     45|KKKK
      |                                                                                                                                 >     46|----
      |                                                                                                                                 >     47|JJJJ
      |                                                                                                                                 >     48|KKKK
      |                                                                                                                                 >     49|KKKK
      |                                                                                                                                 >     50|JJJJ
      |                                                                                                                                 >     51|KKKK
      |                                                                                                                                 >     52|JJJJ
      |                                                                                                                                 >     53|KKKK
      |                                                                                                                                 >     54|JJJJ
      |                                                                                                                                 >     55|----
      |                                                                                                                                 >     56|KKKK  1 CRC16
      |                                                                                                                                 >     57|KKKK  2 CRC16
      |                                                                                                                                 >     58|KKKK  3 CRC16
      |                                                                                                                                 >     59|KKKK  4 CRC16
      |                                                                                                                                 >     60|KKKK  5 CRC16
      |                                                                                                                                 >     61|JJJJ  6 CRC16
      |                                                                                                                                 >     62|JJJJ  7 CRC16
      |                                                                                                                                 >     63|KKKK  8 CRC16
      |                                                                                                                                 >     64|----
      |                                                                                                                                 >     65|JJJJ  9 CRC16
      |                                                                                                                                 >     66|KKKK 10 CRC16
      |                                                                                                                                 >     67|KKKK 11 CRC16
      |                                                                                                                                 >     68|JJJJ 12 CRC16
      |                                                                                                                                 >     69|JJJJ 13 CRC16
      |                                                                                                                                 >     70|KKKK 14 CRC16
      |                                                                                                                                 >     71|KKKK 15 CRC16
      |                                                                                                                                 >     72|KKKK 16 CRC16
      |                                                                                                                                 >     73|----
    20|____ SE0                                                                                                                               74|____ SE0
    21|____ SE0                                                                                                                               75|____ SE0
    22|JJJJ END                                                                                                                               76|JJJJ END

[     ]      |!!!!            ! !++  
[ <-  ]    11|JJJJ 1 PID (PID.NAK  ) 
[  -> ]    11|KKKK 1 PID (PID.DATA1) 

[     ]      |!!!!       
[ <-  ]    12|JJJJ 2 PID 
[  -> ]    12|KKKK 2 PID 

[     ]      |!!!!       
[ <-  ]    13|KKKK 3 PID 
[  -> ]    13|JJJJ 3 PID 

[     ]      |!!!!       
[ <-  ]    14|KKKK 4 PID 
[  -> ]    14|JJJJ 4 PID 


======================================================================
FAIL: test_in_transfer (valentyusb.usbcore.cpu.epmem_test.TestMemInterface)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 825, in test_in_transfer
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 65, in run_sim
    "usb_12": 32,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 53, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 822, in stim
    yield from self.expect_data_packet(PID.DATA0, d[4:])
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 243, in expect_data_packet
    yield from self.expect_packet(data_packet(pid, data), "Expected %s packet with %r" % (pid.name, data))
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 236, in expect_packet
    self.assertMultiLineEqualSideBySide(expected, actual, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 118, in assertMultiLineEqualSideBySide
    return assertMultiLineEqualSideBySide(data1, data2, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/utils/asserts.py", line 44, in assertMultiLineEqualSideBySide
    assert False, msg
AssertionError: Expected DATA0 packet with [5, 6, 7, 8]
      |expected                                                                                                                                 |actual
      |--------                                                                                                                                 |--------
     6|KKKK 5 Sync                                                                                                                             6|KKKK 5 Sync
     7|JJJJ 6 Sync                                                                                                                             7|JJJJ 6 Sync
     8|KKKK 7 Sync                                                                                                                             8|KKKK 7 Sync
     9|KKKK 8 Sync                                                                                                                             9|KKKK 8 Sync
    10|----                                                                                                                                   10|----
    11|KKKK 1 PID (PID.DATA0)                                                                                                           |     11|JJJJ 1 PID (PID.NAK)
    12|KKKK 2 PID                                                                                                                       |     12|JJJJ 2 PID
    13|JJJJ 3 PID                                                                                                                       |     13|KKKK 3 PID
    14|KKKK 4 PID                                                                                                                             14|KKKK 4 PID
    15|JJJJ 5 PID                                                                                                                       |     15|KKKK 5 PID
    16|KKKK 6 PID                                                                                                                       |     16|JJJJ 6 PID
    17|KKKK 7 PID                                                                                                                       |     17|JJJJ 7 PID
    18|KKKK 8 PID                                                                                                                             18|KKKK 8 PID
    19|----                                                                                                                             <       |
    20|KKKK                                                                                                                             <       |
    21|JJJJ                                                                                                                             <       |
    22|JJJJ                                                                                                                             <       |
    23|KKKK                                                                                                                             <       |
    24|JJJJ                                                                                                                             <       |
    25|KKKK                                                                                                                             <       |
    26|JJJJ                                                                                                                             <       |
    27|KKKK                                                                                                                             <       |
    28|----                                                                                                                             <       |
    29|JJJJ                                                                                                                             <       |
    30|JJJJ                                                                                                                             <       |
    31|JJJJ                                                                                                                             <       |
    32|KKKK                                                                                                                             <       |
    33|JJJJ                                                                                                                             <       |
    34|KKKK                                                                                                                             <       |
    35|JJJJ                                                                                                                             <       |
    36|KKKK                                                                                                                             <       |
    37|----                                                                                                                             <       |
    38|KKKK                                                                                                                             <       |
    39|KKKK                                                                                                                             <       |
    40|KKKK                                                                                                                             <       |
    41|JJJJ                                                                                                                             <       |
    42|KKKK                                                                                                                             <       |
    43|JJJJ                                                                                                                             <       |
    44|KKKK                                                                                                                             <       |
    45|JJJJ                                                                                                                             <       |
    46|----                                                                                                                             <       |
    47|KKKK                                                                                                                             <       |
    48|JJJJ                                                                                                                             <       |
    49|KKKK                                                                                                                             <       |
    50|KKKK                                                                                                                             <       |
    51|JJJJ                                                                                                                             <       |
    52|KKKK                                                                                                                             <       |
    53|JJJJ                                                                                                                             <       |
    54|KKKK                                                                                                                             <       |
    55|----                                                                                                                             <       |
    56|JJJJ  1 CRC16                                                                                                                    <       |
    57|KKKK  2 CRC16                                                                                                                    <       |
    58|KKKK  3 CRC16                                                                                                                    <       |
    59|KKKK  4 CRC16                                                                                                                    <       |
    60|KKKK  5 CRC16                                                                                                                    <       |
    61|JJJJ  6 CRC16                                                                                                                    <       |
    62|KKKK  7 CRC16                                                                                                                    <       |
    63|JJJJ  8 CRC16                                                                                                                    <       |
    64|----                                                                                                                             <       |
    65|KKKK  9 CRC16                                                                                                                    <       |
    66|JJJJ 10 CRC16                                                                                                                    <       |
    67|KKKK 11 CRC16                                                                                                                    <       |
    68|JJJJ 12 CRC16                                                                                                                    <       |
    69|KKKK 13 CRC16                                                                                                                    <       |
    70|KKKK 14 CRC16                                                                                                                    <       |
    71|KKKK 15 CRC16                                                                                                                    <       |
    72|KKKK 16 CRC16                                                                                                                    <       |
    73|----                                                                                                                                   19|----
    74|____ SE0                                                                                                                               20|____ SE0
    75|____ SE0                                                                                                                               21|____ SE0
    76|JJJJ END                                                                                                                               22|JJJJ END

[     ]      |!!!!            ! !--  
[ <-  ]    11|KKKK 1 PID (PID.DATA0) 
[  -> ]    11|JJJJ 1 PID (PID.NAK  ) 

[     ]      |!!!!       
[ <-  ]    12|KKKK 2 PID 
[  -> ]    12|JJJJ 2 PID 

[     ]      |!!!!       
[ <-  ]    13|JJJJ 3 PID 
[  -> ]    13|KKKK 3 PID 

[     ]      |!!!!       
[ <-  ]    15|JJJJ 5 PID 
[  -> ]    15|KKKK 5 PID 

[     ]      |!!!!       
[ <-  ]    16|KKKK 6 PID 
[  -> ]    16|JJJJ 6 PID 

[     ]      |!!!!       
[ <-  ]    17|KKKK 7 PID 
[  -> ]    17|JJJJ 7 PID 


======================================================================
FAIL: test_out_stall (valentyusb.usbcore.cpu.epmem_test.TestMemInterface)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 1195, in test_out_stall
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 65, in run_sim
    "usb_12": 32,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 53, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 1171, in stim
    yield from self.expect_nak()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 253, in expect_nak
    yield from self.expect_packet(handshake_packet(PID.NAK), "Expected NAK packet.")
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 236, in expect_packet
    self.assertMultiLineEqualSideBySide(expected, actual, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 118, in assertMultiLineEqualSideBySide
    return assertMultiLineEqualSideBySide(data1, data2, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/utils/asserts.py", line 44, in assertMultiLineEqualSideBySide
    assert False, msg
AssertionError: Expected NAK packet.
      |expected                                                                                                                                 |actual
      |--------                                                                                                                                 |--------
     6|KKKK 5 Sync                                                                                                                             6|KKKK 5 Sync
     7|JJJJ 6 Sync                                                                                                                             7|JJJJ 6 Sync
     8|KKKK 7 Sync                                                                                                                             8|KKKK 7 Sync
     9|KKKK 8 Sync                                                                                                                             9|KKKK 8 Sync
    10|----                                                                                                                                   10|----
    11|JJJJ 1 PID (PID.NAK)                                                                                                             |     11|JJJJ 1 PID (PID.ACK)
    12|JJJJ 2 PID                                                                                                                             12|JJJJ 2 PID
    13|KKKK 3 PID                                                                                                                             13|KKKK 3 PID
    14|KKKK 4 PID                                                                                                                       |     14|JJJJ 4 PID
    15|KKKK 5 PID                                                                                                                       |     15|JJJJ 5 PID
    16|JJJJ 6 PID                                                                                                                       |     16|KKKK 6 PID
    17|JJJJ 7 PID                                                                                                                       |     17|KKKK 7 PID
    18|KKKK 8 PID                                                                                                                             18|KKKK 8 PID
    19|----                                                                                                                                   19|----
    20|____ SE0                                                                                                                               20|____ SE0
    21|____ SE0                                                                                                                               21|____ SE0
    22|JJJJ END                                                                                                                               22|JJJJ END

[     ]      |                - +   
[ <-  ]    11|JJJJ 1 PID (PID.NA K) 
[  -> ]    11|JJJJ 1 PID (PID. ACK) 

[     ]      |!!!!       
[ <-  ]    14|KKKK 4 PID 
[  -> ]    14|JJJJ 4 PID 

[     ]      |!!!!       
[ <-  ]    15|KKKK 5 PID 
[  -> ]    15|JJJJ 5 PID 

[     ]      |!!!!       
[ <-  ]    16|JJJJ 6 PID 
[  -> ]    16|KKKK 6 PID 

[     ]      |!!!!       
[ <-  ]    17|JJJJ 7 PID 
[  -> ]    17|KKKK 7 PID 


======================================================================
FAIL: test_out_transfer (valentyusb.usbcore.cpu.epmem_test.TestMemInterface)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 1117, in test_out_transfer
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 65, in run_sim
    "usb_12": 32,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 53, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 1113, in stim
    yield from self.expect_ack()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 248, in expect_ack
    yield from self.expect_packet(handshake_packet(PID.ACK), "Expected ACK packet.")
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 236, in expect_packet
    self.assertMultiLineEqualSideBySide(expected, actual, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 118, in assertMultiLineEqualSideBySide
    return assertMultiLineEqualSideBySide(data1, data2, msg)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/utils/asserts.py", line 44, in assertMultiLineEqualSideBySide
    assert False, msg
AssertionError: Expected ACK packet.
      |expected                                                                                                                                 |actual
      |--------                                                                                                                                 |--------
     6|KKKK 5 Sync                                                                                                                             6|KKKK 5 Sync
     7|JJJJ 6 Sync                                                                                                                             7|JJJJ 6 Sync
     8|KKKK 7 Sync                                                                                                                             8|KKKK 7 Sync
     9|KKKK 8 Sync                                                                                                                             9|KKKK 8 Sync
    10|----                                                                                                                                   10|----
    11|JJJJ 1 PID (PID.ACK)                                                                                                             |     11|JJJJ 1 PID (PID.NAK)
    12|JJJJ 2 PID                                                                                                                             12|JJJJ 2 PID
    13|KKKK 3 PID                                                                                                                             13|KKKK 3 PID
    14|JJJJ 4 PID                                                                                                                       |     14|KKKK 4 PID
    15|JJJJ 5 PID                                                                                                                       |     15|KKKK 5 PID
    16|KKKK 6 PID                                                                                                                       |     16|JJJJ 6 PID
    17|KKKK 7 PID                                                                                                                       |     17|JJJJ 7 PID
    18|KKKK 8 PID                                                                                                                             18|KKKK 8 PID
    19|----                                                                                                                                   19|----
    20|____ SE0                                                                                                                               20|____ SE0
    21|____ SE0                                                                                                                               21|____ SE0
    22|JJJJ END                                                                                                                               22|JJJJ END

[     ]      |                + -   
[ <-  ]    11|JJJJ 1 PID (PID. ACK) 
[  -> ]    11|JJJJ 1 PID (PID.NA K) 

[     ]      |!!!!       
[ <-  ]    14|JJJJ 4 PID 
[  -> ]    14|KKKK 4 PID 

[     ]      |!!!!       
[ <-  ]    15|JJJJ 5 PID 
[  -> ]    15|KKKK 5 PID 

[     ]      |!!!!       
[ <-  ]    16|KKKK 6 PID 
[  -> ]    16|JJJJ 6 PID 

[     ]      |!!!!       
[ <-  ]    17|KKKK 7 PID 
[  -> ]    17|JJJJ 7 PID 


======================================================================
FAIL: test_setup_clears_data_toggle_bit (valentyusb.usbcore.cpu.epmem_test.TestMemInterface)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 952, in test_setup_clears_data_toggle_bit
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 65, in run_sim
    "usb_12": 32,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/epmem_test.py", line 53, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 898, in stim
    self.assertTrue(dtbi)
AssertionError: False is not true

----------------------------------------------------------------------
Ran 21 tests in 397.154s

FAILED (failures=11)
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.cpu.unififo_test
test_control_setup (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_control_setup_clears_stall (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_control_transfer_in (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_control_transfer_in_nak_data (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_control_transfer_in_nak_status (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_control_transfer_out (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_control_transfer_out_nak_data (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_control_transfer_out_nak_status (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_data_in_byte_1 (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_data_in_byte_2 (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_data_in_byte_a (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_data_toggle_bit_multiple_endpoints (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_in_stall (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_in_transfer (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_in_transfer_nak (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_out_stall (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_out_transfer (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_out_transfer_nak (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_setup_clears_data_toggle_bit (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... ok
test_sof_is_ignored (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... FAIL
test_sof_stuffing (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo) ... FAIL

======================================================================
FAIL: test_sof_is_ignored (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 571, in test_sof_is_ignored
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/unififo_test.py", line 113, in run_sim
    clocks=clocks,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/unififo_test.py", line 99, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 504, in stim
    yield from self.tick_usb12()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/unififo_test.py", line 182, in tick_usb12
    yield from self.tick_usb48()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/unififo_test.py", line 178, in tick_usb48
    yield from self.wait_for_edge("usb_48")
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/clock.py", line 28, in wait_for_edge
    yield from self.update_internal_signals()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/unififo_test.py", line 258, in update_internal_signals
    assert False, pid
AssertionError: PID.SOF

======================================================================
FAIL: test_sof_stuffing (valentyusb.usbcore.cpu.unififo_test.TestUsbUniFifo)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 484, in test_sof_stuffing
    self.run_sim(stim)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/unififo_test.py", line 113, in run_sim
    clocks=clocks,
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/unififo_test.py", line 99, in padfront
    yield from stim()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/common.py", line 462, in stim
    yield from self.tick_usb12()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/unififo_test.py", line 182, in tick_usb12
    yield from self.tick_usb48()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/unififo_test.py", line 178, in tick_usb48
    yield from self.wait_for_edge("usb_48")
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/test/clock.py", line 28, in wait_for_edge
    yield from self.update_internal_signals()
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/cpu/unififo_test.py", line 258, in update_internal_signals
    assert False, pid
AssertionError: PID.SOF

----------------------------------------------------------------------
Ran 21 tests in 767.853s

FAILED (failures=2)
./run_all_tests.sh: line 7: ----------: command not found
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.io_test
test_recv_idle (valentyusb.usbcore.io_test.TestFakeIoBuf) ... ok
test_recv_j (valentyusb.usbcore.io_test.TestFakeIoBuf) ... ok
test_recv_k (valentyusb.usbcore.io_test.TestFakeIoBuf) ... ok
test_recv_se0 (valentyusb.usbcore.io_test.TestFakeIoBuf) ... ok
test_recv_se0_alias (valentyusb.usbcore.io_test.TestFakeIoBuf) ... ok

----------------------------------------------------------------------
Ran 5 tests in 0.010s

OK
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.rx.bitstuff_test
test_bit_stuff (valentyusb.usbcore.rx.bitstuff_test.TestRxBitstuffRemover) ... ok
test_bit_stuff_after_reset (valentyusb.usbcore.rx.bitstuff_test.TestRxBitstuffRemover) ... ok
test_bit_stuff_error (valentyusb.usbcore.rx.bitstuff_test.TestRxBitstuffRemover) ... ok
test_bit_stuff_error_after_reset (valentyusb.usbcore.rx.bitstuff_test.TestRxBitstuffRemover) ... ok
test_captured_setup_packet_no_stuff (valentyusb.usbcore.rx.bitstuff_test.TestRxBitstuffRemover) ... ok
test_idle_packet_idle (valentyusb.usbcore.rx.bitstuff_test.TestRxBitstuffRemover) ... ok
test_idle_packet_idle_packet_idle (valentyusb.usbcore.rx.bitstuff_test.TestRxBitstuffRemover) ... ok
test_mixed_bit_stuff_error (valentyusb.usbcore.rx.bitstuff_test.TestRxBitstuffRemover) ... ok
test_multiple_bit_stuff_scenario (valentyusb.usbcore.rx.bitstuff_test.TestRxBitstuffRemover) ... ok
test_no_bit_stuff (valentyusb.usbcore.rx.bitstuff_test.TestRxBitstuffRemover) ... ok
test_valid_captured_setup_packet_no_stuff (valentyusb.usbcore.rx.bitstuff_test.TestRxBitstuffRemover) ... ok
test_valid_idle_packet_idle_packet_idle (valentyusb.usbcore.rx.bitstuff_test.TestRxBitstuffRemover) ... ok

----------------------------------------------------------------------
Ran 12 tests in 0.096s

OK
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.rx.clock_test
test_0 (valentyusb.usbcore.rx.clock_test.TestRxClockDataRecovery) ... test_1 (valentyusb.usbcore.rx.clock_test.TestRxClockDataRecovery) ... ok
test_j (valentyusb.usbcore.rx.clock_test.TestRxClockDataRecovery) ... ok
test_jjjkj0j1kjkkk0k10j0k00011j1k1011 (valentyusb.usbcore.rx.clock_test.TestRxClockDataRecovery) ... ok
test_jk01 (valentyusb.usbcore.rx.clock_test.TestRxClockDataRecovery) ... ok
test_k (valentyusb.usbcore.rx.clock_test.TestRxClockDataRecovery) ... ok
test_kkkkk0k0kjjjk0kkkkjjjkjkjkjjj0kj (valentyusb.usbcore.rx.clock_test.TestRxClockDataRecovery) ... ok

======================================================================
FAIL: test_0 (valentyusb.usbcore.rx.clock_test.TestRxClockDataRecovery) (seq='0')
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/rx/clock_test.py", line 90, in basic_recovery_test
    testsuffix="clock.basic_recovery_%s" % seq),
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 414, in run_simulation
    s.run()
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 403, in run
    self._process_generators(cd)
  File "/opt/usbalex/foboot/hw/deps/migen/migen/sim/core.py", line 357, in _process_generators
    request = generator.send(reply)
  File "/opt/usbalex/foboot/hw/deps/valentyusb/valentyusb/usbcore/rx/clock_test.py", line 76, in stim
    self.assertEqual(out_seq, seq)
AssertionError: '00' != '0'
- 00
? -
+ 0


----------------------------------------------------------------------
Ran 7 tests in 0.088s

FAILED (failures=1)
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.rx.crc_test
test_usb2_data_with_bad_crc16 (valentyusb.usbcore.rx.crc_test.TestRxCrcChecker) ... ok
test_usb2_data_with_good_crc16 (valentyusb.usbcore.rx.crc_test.TestRxCrcChecker) ... ok
test_usb2_token_with_bad_crc5 (valentyusb.usbcore.rx.crc_test.TestRxCrcChecker) ... ok
test_usb2_token_with_bad_crc5_2 (valentyusb.usbcore.rx.crc_test.TestRxCrcChecker) ... ok
test_usb2_token_with_good_crc5 (valentyusb.usbcore.rx.crc_test.TestRxCrcChecker) ... ok
test_usb2_token_with_good_crc5_1_2 (valentyusb.usbcore.rx.crc_test.TestRxCrcChecker) ... ok
test_usb2_token_with_good_crc5_2 (valentyusb.usbcore.rx.crc_test.TestRxCrcChecker) ... ok
test_usb2_token_with_good_crc5_and_pipeline_stalls (valentyusb.usbcore.rx.crc_test.TestRxCrcChecker) ... ok

----------------------------------------------------------------------
Ran 8 tests in 0.119s

OK
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.rx.detect_test
test_idle_glitch (valentyusb.usbcore.rx.detect_test.TestRxPacketDetect) ... ok
test_idle_packet_idle (valentyusb.usbcore.rx.detect_test.TestRxPacketDetect) ... ok
test_idle_packet_idle_packet_idle (valentyusb.usbcore.rx.detect_test.TestRxPacketDetect) ... ok
test_idle_packet_idle_stall (valentyusb.usbcore.rx.detect_test.TestRxPacketDetect) ... ok
test_idle_packet_idle_stalls (valentyusb.usbcore.rx.detect_test.TestRxPacketDetect) ... ok
test_idle_sync_idle (valentyusb.usbcore.rx.detect_test.TestRxPacketDetect) ... ok
test_se0_idle (valentyusb.usbcore.rx.detect_test.TestRxPacketDetect) ... ok
test_valid_idle_packet_idle_packet_idle (valentyusb.usbcore.rx.detect_test.TestRxPacketDetect) ... ok

----------------------------------------------------------------------
Ran 8 tests in 0.117s

OK
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.rx.nrzi_test
test_captured_setup_packet (valentyusb.usbcore.rx.nrzi_test.TestRxNRZIDecoder) ... ok
test_captured_setup_packet_stalls (valentyusb.usbcore.rx.nrzi_test.TestRxNRZIDecoder) ... ok
test_usb2_spec_7_1_8 (valentyusb.usbcore.rx.nrzi_test.TestRxNRZIDecoder) ... ok
test_usb2_spec_7_1_9_1 (valentyusb.usbcore.rx.nrzi_test.TestRxNRZIDecoder) ... ok
test_usb2_spec_7_1_9_1_stalls (valentyusb.usbcore.rx.nrzi_test.TestRxNRZIDecoder) ... ok
test_usb2_spec_7_1_9_1_stalls_2 (valentyusb.usbcore.rx.nrzi_test.TestRxNRZIDecoder) ... ok
test_usb2_spec_7_1_9_1_stalls_3 (valentyusb.usbcore.rx.nrzi_test.TestRxNRZIDecoder) ... ok
test_usb2_spec_7_1_9_1_stalls_se0_glitch (valentyusb.usbcore.rx.nrzi_test.TestRxNRZIDecoder) ... ok

----------------------------------------------------------------------
Ran 8 tests in 0.066s

OK
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.rx.pipeline_test
test_usb2_ack_handshake (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_ack_handshake_eop_dribble_1 (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_ack_handshake_eop_dribble_6 (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_ack_handshake_pid_error (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_data_with_bad_crc16 (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_data_with_good_crc16 (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_data_with_good_crc16_1_eop_dribble (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_data_with_good_crc16_6_eop_dribble (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_sof_stuffed_end (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_sof_stuffed_mid (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_sof_token (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_sof_token_1 (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_sof_token_bad_crc5 (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_sof_token_bad_pid (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_sof_token_eop_dribble_1 (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok
test_usb2_sof_token_eop_dribble_6 (valentyusb.usbcore.rx.pipeline_test.TestRxPipeline) ... ok

----------------------------------------------------------------------
Ran 16 tests in 21.581s

OK
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.rx.shifter_test
test_basic_shift_in (valentyusb.usbcore.rx.shifter_test.TestRxShifter) ... ok
test_basic_shift_in_1 (valentyusb.usbcore.rx.shifter_test.TestRxShifter) ... ok
test_basic_shift_in_2 (valentyusb.usbcore.rx.shifter_test.TestRxShifter) ... ok
test_basic_shift_in_2_bytes (valentyusb.usbcore.rx.shifter_test.TestRxShifter) ... ok
test_basic_shift_in_3 (valentyusb.usbcore.rx.shifter_test.TestRxShifter) ... ok
test_basic_shift_in_4 (valentyusb.usbcore.rx.shifter_test.TestRxShifter) ... ok
test_basic_shift_in_5 (valentyusb.usbcore.rx.shifter_test.TestRxShifter) ... ok
test_basic_shift_in_6 (valentyusb.usbcore.rx.shifter_test.TestRxShifter) ... ok
test_basic_shift_in_7 (valentyusb.usbcore.rx.shifter_test.TestRxShifter) ... ok
test_multiple_resets (valentyusb.usbcore.rx.shifter_test.TestRxShifter) ... ok
test_multiple_resets_tight_timing (valentyusb.usbcore.rx.shifter_test.TestRxShifter) ... ok

----------------------------------------------------------------------
Ran 11 tests in 0.058s

OK
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.sm.header_test
test_decode_ack (valentyusb.usbcore.sm.header_test.TestPacketHeaderDecode) ... ok
test_decode_data0 (valentyusb.usbcore.sm.header_test.TestPacketHeaderDecode) ... ok
test_decode_data1 (valentyusb.usbcore.sm.header_test.TestPacketHeaderDecode) ... ok
test_decode_in_ep1 (valentyusb.usbcore.sm.header_test.TestPacketHeaderDecode) ... ok
test_decode_nak (valentyusb.usbcore.sm.header_test.TestPacketHeaderDecode) ... ok
test_decode_out_ep8 (valentyusb.usbcore.sm.header_test.TestPacketHeaderDecode) ... ok
test_decode_setup_zero (valentyusb.usbcore.sm.header_test.TestPacketHeaderDecode) ... ok

----------------------------------------------------------------------
Ran 7 tests in 4.882s

OK
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.sm.send_test
test_ack (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_data0_all_zero (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_data0_dat1234 (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_data0_descriptor (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_data0_edges (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_data0_one_one (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_data0_one_zero (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_data0_two_ones (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_data1_all_zero (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_nak (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_stall (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_status0 (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_status1 (valentyusb.usbcore.sm.send_test.TestTxPacketSendAutoCrc) ... ok
test_ack (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok
test_data0_all_zero (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok
test_data0_dat1234 (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok
test_data0_descriptor (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok
test_data0_edges (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok
test_data0_one_one (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok
test_data0_one_zero (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok
test_data0_two_ones (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok
test_data1_all_zero (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok
test_nak (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok
test_stall (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok
test_status0 (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok
test_status1 (valentyusb.usbcore.sm.send_test.TestTxPacketSendNoCrc) ... ok

----------------------------------------------------------------------
Ran 26 tests in 24.313s

OK
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.sm.transfer_test
test_control_setup (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_control_setup_clears_stall (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_control_transfer_in (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_control_transfer_in_nak_data (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_control_transfer_in_nak_status (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_control_transfer_out (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_control_transfer_out_nak_data (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_control_transfer_out_nak_status (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_data_in_byte_1 (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_data_in_byte_2 (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_data_in_byte_a (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_data_toggle_bit_multiple_endpoints (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_in_stall (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_in_transfer (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_in_transfer_nak (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_out_stall (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_out_transfer (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_out_transfer_nak (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_setup_clears_data_toggle_bit (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_sof_is_ignored (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok
test_sof_stuffing (valentyusb.usbcore.sm.transfer_test.TestUsbTransfer) ... ok

----------------------------------------------------------------------
Ran 21 tests in 469.764s

OK
./run_all_tests.sh: line 7: ----------: command not found
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.tx.bitstuff_test
test_bitstuff (valentyusb.usbcore.tx.bitstuff_test.TestTxBitstuffer) ... ok
test_bitstuff_at_eop (valentyusb.usbcore.tx.bitstuff_test.TestTxBitstuffer) ... ok
test_bitstuff_input_stall (valentyusb.usbcore.tx.bitstuff_test.TestTxBitstuffer) ... ok
test_bitstuff_se0 (valentyusb.usbcore.tx.bitstuff_test.TestTxBitstuffer) ... ok
test_multi_bitstuff (valentyusb.usbcore.tx.bitstuff_test.TestTxBitstuffer) ... ok
test_passthrough (valentyusb.usbcore.tx.bitstuff_test.TestTxBitstuffer) ... ok
test_passthrough_se0 (valentyusb.usbcore.tx.bitstuff_test.TestTxBitstuffer) ... ok

----------------------------------------------------------------------
Ran 7 tests in 0.062s

OK
./run_all_tests.sh: line 7: len:: command not found
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.tx.crc_test
test_data_crc16_nonzero1 (valentyusb.usbcore.tx.crc_test.TestTxParallelCrcGenerator) ... ok
test_data_crc16_nonzero2 (valentyusb.usbcore.tx.crc_test.TestTxParallelCrcGenerator) ... ok
test_token_crc5_nonzero1 (valentyusb.usbcore.tx.crc_test.TestTxParallelCrcGenerator) ... ok
test_token_crc5_zeroes (valentyusb.usbcore.tx.crc_test.TestTxParallelCrcGenerator) ... ok

----------------------------------------------------------------------
Ran 4 tests in 0.066s

OK
./run_all_tests.sh: line 7: crc16: command not found
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.tx.nrzi_test
test_setup_token (valentyusb.usbcore.tx.nrzi_test.TestTxNRZIEncoder) ... ok

----------------------------------------------------------------------
Ran 1 test in 0.022s

OK
./run_all_tests.sh: line 7: len:: command not found
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.tx.pipeline_test
test_usb2_ack_handshake (valentyusb.usbcore.tx.pipeline_test.TestTxPipeline) ... ok
test_usb2_ack_handshake_pid_error (valentyusb.usbcore.tx.pipeline_test.TestTxPipeline) ... ok
test_usb2_data_with_bad_crc16 (valentyusb.usbcore.tx.pipeline_test.TestTxPipeline) ... ok
test_usb2_data_with_good_crc16 (valentyusb.usbcore.tx.pipeline_test.TestTxPipeline) ... ok
test_usb2_sof_token (valentyusb.usbcore.tx.pipeline_test.TestTxPipeline) ... ok
test_usb2_sof_token_bad_crc5 (valentyusb.usbcore.tx.pipeline_test.TestTxPipeline) ... ok
test_usb2_sof_token_bad_pid (valentyusb.usbcore.tx.pipeline_test.TestTxPipeline) ... ok

----------------------------------------------------------------------
Ran 7 tests in 3.023s

OK
python3 ../../lxbuildenv.py -r -m unittest -v valentyusb.usbcore.tx.shifter_test
test_basic_shift_out_1 (valentyusb.usbcore.tx.shifter_test.TestTxShifter) ... ok
test_basic_shift_out_2 (valentyusb.usbcore.tx.shifter_test.TestTxShifter) ... ok
test_basic_shift_out_3 (valentyusb.usbcore.tx.shifter_test.TestTxShifter) ... ok
test_multistall_shift_out_1 (valentyusb.usbcore.tx.shifter_test.TestTxShifter) ... ok
test_multistall_shift_out_2 (valentyusb.usbcore.tx.shifter_test.TestTxShifter) ... ok
test_multistall_shift_out_3 (valentyusb.usbcore.tx.shifter_test.TestTxShifter) ... ok
test_stall_shift_out_1 (valentyusb.usbcore.tx.shifter_test.TestTxShifter) ... ok
test_stall_shift_out_2 (valentyusb.usbcore.tx.shifter_test.TestTxShifter) ... ok
test_stall_shift_out_3 (valentyusb.usbcore.tx.shifter_test.TestTxShifter) ... ok

----------------------------------------------------------------------
Ran 9 tests in 0.067s

OK
